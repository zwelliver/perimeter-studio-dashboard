import{j as a}from"./index-DfFXyd2D.js";import{r as m}from"./chart-vendor-nXq5J5EI.js";import{f as c,p as t}from"./date-vendor-QvLKA523.js";import"./pdf-vendor-CwNtiuTz.js";import"./csv-vendor-NuAurQ9B.js";function f({item:s,type:d,onClose:i}){const[e,n]=m.useState("idle"),[o,h]=m.useState("");if(!s)return null;const j=async()=>{if(s.gid){n("loading"),h("");try{const l=await fetch(`/api/tasks/${s.gid}/mark-filmed`,{method:"POST"});if(!l.ok){const r=await l.json().catch(()=>({}));throw new Error(r.detail||"Failed to mark as filmed")}n("success")}catch(l){h(l.message),n("error")}}},x=()=>a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsx("h2",{children:s.name}),a.jsx("button",{className:"close-modal",onClick:i,children:"âœ•"})]}),a.jsxs("div",{className:"detail-grid",children:[a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“ Project"}),a.jsx("span",{className:"detail-value",children:s.project})]}),a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ‘¤ Assignee"}),a.jsx("span",{className:"detail-value",children:s.assignee||"Unassigned"})]}),s.videographer&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ¥ Videographer"}),a.jsx("span",{className:"detail-value",children:s.videographer})]}),s.due_on&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“… Due Date"}),a.jsx("span",{className:"detail-value",children:s.due_on})]})]}),s.risks&&s.risks.length>0&&a.jsxs("div",{className:"risk-section",children:[a.jsx("h3",{children:"âš ï¸ Risk Factors"}),a.jsx("ul",{className:"risk-list-detail",children:s.risks.map((l,r)=>a.jsx("li",{children:l},r))})]}),a.jsx("div",{className:"detail-actions",children:a.jsx("a",{href:`https://app.asana.com/0/0/${s.gid||""}/f`,target:"_blank",rel:"noopener noreferrer",className:"asana-link-btn",children:"Open in Asana â†’"})})]}),p=()=>a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsxs("h2",{children:["ğŸ¬ ",s.name]}),a.jsx("button",{className:"close-modal",onClick:i,children:"âœ•"})]}),a.jsxs("div",{className:"detail-grid",children:[a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“ Project"}),a.jsx("span",{className:"detail-value",children:s.project})]}),a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“… Film Date"}),a.jsx("span",{className:"detail-value",children:c(t(s.datetime),"EEEE, MMMM d, yyyy")})]}),a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ• Time"}),a.jsx("span",{className:"detail-value",children:c(t(s.datetime),"h:mm a")})]}),s.start_on&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"â–¶ï¸ Start Date"}),a.jsx("span",{className:"detail-value",children:s.start_on})]}),s.due_on&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ Due Date"}),a.jsx("span",{className:"detail-value",children:s.due_on})]})]}),a.jsxs("div",{className:"detail-actions",children:[s.gid&&a.jsxs("button",{className:`mark-filmed-btn ${e}`,onClick:j,disabled:e==="loading"||e==="success",children:[e==="idle"&&"Mark Filmed",e==="loading"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner"})," Updating..."]}),e==="success"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"checkmark",children:"âœ“"})," Filmed"]}),e==="error"&&"Retry â€” Mark Filmed"]}),a.jsx("a",{href:`https://app.asana.com/0/0/${s.gid||""}/f`,target:"_blank",rel:"noopener noreferrer",className:"asana-link-btn",children:"Open in Asana â†’"})]}),e==="error"&&o&&a.jsx("p",{className:"filmed-error",children:o})]}),N=()=>a.jsxs("div",{className:"detail-content",children:[a.jsxs("div",{className:"detail-header",children:[a.jsxs("h2",{children:["â° ",s.name]}),a.jsx("button",{className:"close-modal",onClick:i,children:"âœ•"})]}),a.jsxs("div",{className:"detail-grid",children:[a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“ Project"}),a.jsx("span",{className:"detail-value",children:s.project})]}),a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"ğŸ“… Due Date"}),a.jsx("span",{className:"detail-value",children:c(t(s.due_date),"EEEE, MMMM d, yyyy")})]}),a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"â³ Days Until"}),a.jsx("span",{className:`detail-value ${s.days_until<=2?"urgent":s.days_until<=5?"warning":""}`,children:s.days_until===0?"Due Today!":s.days_until===1?"Due Tomorrow":`${s.days_until} days`})]}),s.start_on&&a.jsxs("div",{className:"detail-item",children:[a.jsx("span",{className:"detail-label",children:"â–¶ï¸ Start Date"}),a.jsx("span",{className:"detail-value",children:s.start_on})]})]}),a.jsx("div",{className:"detail-actions",children:a.jsx("a",{href:`https://app.asana.com/0/0/${s.gid||""}/f`,target:"_blank",rel:"noopener noreferrer",className:"asana-link-btn",children:"Open in Asana â†’"})})]});return a.jsx("div",{className:"modal-overlay",onClick:i,children:a.jsxs("div",{className:"modal-container",onClick:l=>l.stopPropagation(),children:[d==="task"&&x(),d==="shoot"&&p(),d==="deadline"&&N()]})})}export{f as default};
